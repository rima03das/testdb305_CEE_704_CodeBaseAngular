export class UndoRedo {
    constructor() { }
    historyStack = [];
    currentIndex = -1;
    name = 'StateHistory';
    currentId = 'currentId';
    push(id, values) {
        const obj = {};
        const data = this.getData();
        if (data) {
            if (data[id]) {
                this.historyStack = [];
                this.historyStack = data[id];
            }
        }
        this.historyStack.push(values);
        obj[id] = this.historyStack;
        this.setData(obj);
    }
    forward() {
        // TODO
        // if (this.currentIndex < this.historyStack.length - 1) {
        //     this.currentIndex++;
        //     return this.historyStack[this.currentIndex];
        // }
        // return this.historyStack[this.currentIndex];
    }
    undo(id) {
        if (id === this.getCurrentId()) {
            const obj = {};
            const data = this.getData();
            if (data) {
                if (data[id]) {
                    // this.historyStack = [];
                    const arr = data[id];
                    arr.pop();
                    obj[id] = arr;
                    this.setData(obj);
                }
            }
        }
    }
    undoCurrentId() {
        const id = this.getCurrentId();
        const obj = {};
        const data = this.getData();
        if (data) {
            if (data[id]) {
                // this.historyStack = [];
                const arr = data[id];
                arr.pop();
                obj[id] = arr;
                this.setData(obj);
            }
        }
    }
    getPresentValue(id) {
        const data = this.getData() ? this.getData()[id] : undefined;
        return data ? data[data.length - 1] : null;
    }
    setData(data) {
        let obj = data;
        const prevData = this.getData();
        if (prevData) {
            obj = { ...prevData, ...obj };
        }
        window.sessionStorage.setItem(this.name, btoa(JSON.stringify(obj)));
    }
    getData() {
        const data = window.sessionStorage.getItem(this.name);
        return data !== null ? JSON.parse(atob(data)) : undefined;
    }
    setCurrentId(id) {
        window.sessionStorage.setItem(this.currentId, btoa(id));
    }
    getCurrentId() {
        const currentId = window.sessionStorage.getItem(this.currentId);
        return currentId !== null ? atob(currentId) : null;
    }
    deletById(id) {
        const data = this.getData();
        if (data) {
            const sessionArray = Object.keys(data);
            const newArray = sessionArray.filter(item => {
                return !id.includes(item);
            });
            const obj = {};
            for (const key of newArray) {
                if (data[key] !== undefined) {
                    obj[key] = data[key];
                }
            }
            window.sessionStorage.setItem(this.name, btoa(JSON.stringify(obj)));
        }
    }
    removeAll() {
        window.sessionStorage.removeItem(this.currentId);
        window.sessionStorage.removeItem(this.name);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidW5kby1yZWRvLnV0aWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9Bbmd1bGFyLTE3L0VTRi1Bbmd1bGFyLVdGRS1MaWJyYXJ5L3Byb2plY3RzL25nLWNlZS1jb3JlL3NyYy9saWIvdXRpbHMvdW5kby1yZWRvLnV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTSxPQUFPLFFBQVE7SUFDakIsZ0JBQWdCLENBQUM7SUFFakIsWUFBWSxHQUFlLEVBQUUsQ0FBQztJQUM5QixZQUFZLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDbEIsSUFBSSxHQUFHLGNBQWMsQ0FBQztJQUN0QixTQUFTLEdBQUcsV0FBVyxDQUFDO0lBRXhCLElBQUksQ0FBQyxFQUFFLEVBQUUsTUFBTTtRQUNYLE1BQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQztRQUNmLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUM1QixJQUFJLElBQUksRUFBRTtZQUNOLElBQUksSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFO2dCQUNWLElBQUksQ0FBQyxZQUFZLEdBQUcsRUFBRSxDQUFDO2dCQUN2QixJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQzthQUNoQztTQUNKO1FBQ0QsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDL0IsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUM7UUFDNUIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUN0QixDQUFDO0lBRUQsT0FBTztRQUNILE9BQU87UUFDUCwwREFBMEQ7UUFDMUQsMkJBQTJCO1FBQzNCLG1EQUFtRDtRQUNuRCxJQUFJO1FBQ0osK0NBQStDO0lBQ25ELENBQUM7SUFFRCxJQUFJLENBQUMsRUFBRTtRQUNILElBQUksRUFBRSxLQUFLLElBQUksQ0FBQyxZQUFZLEVBQUUsRUFBRTtZQUM1QixNQUFNLEdBQUcsR0FBRyxFQUFFLENBQUM7WUFDZixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7WUFDNUIsSUFBSSxJQUFJLEVBQUU7Z0JBQ04sSUFBSSxJQUFJLENBQUMsRUFBRSxDQUFDLEVBQUU7b0JBQ1YsMEJBQTBCO29CQUMxQixNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7b0JBQ3JCLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztvQkFDVixHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxDQUFDO29CQUNkLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7aUJBQ3JCO2FBQ0o7U0FDSjtJQUNMLENBQUM7SUFFRCxhQUFhO1FBQ1QsTUFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1FBQy9CLE1BQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQztRQUNmLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUM1QixJQUFJLElBQUksRUFBRTtZQUNOLElBQUksSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFO2dCQUNWLDBCQUEwQjtnQkFDMUIsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO2dCQUNyQixHQUFHLENBQUMsR0FBRyxFQUFFLENBQUM7Z0JBQ1YsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEdBQUcsQ0FBQztnQkFDZCxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2FBQ3JCO1NBQ0o7SUFDTCxDQUFDO0lBRUQsZUFBZSxDQUFDLEVBQUU7UUFDZCxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO1FBQzdELE9BQU8sSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0lBQy9DLENBQUM7SUFFTyxPQUFPLENBQUMsSUFBSTtRQUNoQixJQUFJLEdBQUcsR0FBRyxJQUFJLENBQUM7UUFDZixNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDaEMsSUFBSSxRQUFRLEVBQUU7WUFDVixHQUFHLEdBQUcsRUFBRSxHQUFHLFFBQVEsRUFBRSxHQUFHLEdBQUcsRUFBRSxDQUFDO1NBQ2pDO1FBQ0QsTUFBTSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDeEUsQ0FBQztJQUVPLE9BQU87UUFDWCxNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdEQsT0FBTyxJQUFJLEtBQUssSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7SUFDOUQsQ0FBQztJQUVELFlBQVksQ0FBQyxFQUFFO1FBQ1gsTUFBTSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUM1RCxDQUFDO0lBRUQsWUFBWTtRQUNSLE1BQU0sU0FBUyxHQUFHLE1BQU0sQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNoRSxPQUFPLFNBQVMsS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0lBQ3ZELENBQUM7SUFFRCxTQUFTLENBQUMsRUFBRTtRQUNSLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUM1QixJQUFJLElBQUksRUFBRTtZQUNOLE1BQU0sWUFBWSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDdkMsTUFBTSxRQUFRLEdBQUcsWUFBWSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRTtnQkFDeEMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDOUIsQ0FBQyxDQUFDLENBQUM7WUFDSCxNQUFNLEdBQUcsR0FBRyxFQUFFLENBQUM7WUFDZixLQUFLLE1BQU0sR0FBRyxJQUFJLFFBQVEsRUFBRTtnQkFDeEIsSUFBSSxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssU0FBUyxFQUFFO29CQUN6QixHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2lCQUN4QjthQUNKO1lBQ0QsTUFBTSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDdkU7SUFDTCxDQUFDO0lBRUQsU0FBUztRQUNMLE1BQU0sQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNqRCxNQUFNLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDaEQsQ0FBQztDQUNKIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIFVuZG9SZWRvIHtcclxuICAgIGNvbnN0cnVjdG9yKCkgeyB9XHJcblxyXG4gICAgaGlzdG9yeVN0YWNrOiBBcnJheTxhbnk+ID0gW107XHJcbiAgICBjdXJyZW50SW5kZXggPSAtMTtcclxuICAgIG5hbWUgPSAnU3RhdGVIaXN0b3J5JztcclxuICAgIGN1cnJlbnRJZCA9ICdjdXJyZW50SWQnO1xyXG5cclxuICAgIHB1c2goaWQsIHZhbHVlcykge1xyXG4gICAgICAgIGNvbnN0IG9iaiA9IHt9O1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmdldERhdGEoKTtcclxuICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoZGF0YVtpZF0pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGlzdG9yeVN0YWNrID0gW107XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhpc3RvcnlTdGFjayA9IGRhdGFbaWRdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaGlzdG9yeVN0YWNrLnB1c2godmFsdWVzKTtcclxuICAgICAgICBvYmpbaWRdID0gdGhpcy5oaXN0b3J5U3RhY2s7XHJcbiAgICAgICAgdGhpcy5zZXREYXRhKG9iaik7XHJcbiAgICB9XHJcblxyXG4gICAgZm9yd2FyZCgpIHtcclxuICAgICAgICAvLyBUT0RPXHJcbiAgICAgICAgLy8gaWYgKHRoaXMuY3VycmVudEluZGV4IDwgdGhpcy5oaXN0b3J5U3RhY2subGVuZ3RoIC0gMSkge1xyXG4gICAgICAgIC8vICAgICB0aGlzLmN1cnJlbnRJbmRleCsrO1xyXG4gICAgICAgIC8vICAgICByZXR1cm4gdGhpcy5oaXN0b3J5U3RhY2tbdGhpcy5jdXJyZW50SW5kZXhdO1xyXG4gICAgICAgIC8vIH1cclxuICAgICAgICAvLyByZXR1cm4gdGhpcy5oaXN0b3J5U3RhY2tbdGhpcy5jdXJyZW50SW5kZXhdO1xyXG4gICAgfVxyXG5cclxuICAgIHVuZG8oaWQpIHtcclxuICAgICAgICBpZiAoaWQgPT09IHRoaXMuZ2V0Q3VycmVudElkKCkpIHtcclxuICAgICAgICAgICAgY29uc3Qgb2JqID0ge307XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmdldERhdGEoKTtcclxuICAgICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhW2lkXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuaGlzdG9yeVN0YWNrID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXJyID0gZGF0YVtpZF07XHJcbiAgICAgICAgICAgICAgICAgICAgYXJyLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG9ialtpZF0gPSBhcnI7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXREYXRhKG9iaik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdW5kb0N1cnJlbnRJZCgpIHtcclxuICAgICAgICBjb25zdCBpZCA9IHRoaXMuZ2V0Q3VycmVudElkKCk7XHJcbiAgICAgICAgY29uc3Qgb2JqID0ge307XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZ2V0RGF0YSgpO1xyXG4gICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhW2lkXSkge1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5oaXN0b3J5U3RhY2sgPSBbXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFyciA9IGRhdGFbaWRdO1xyXG4gICAgICAgICAgICAgICAgYXJyLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgb2JqW2lkXSA9IGFycjtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0RGF0YShvYmopO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldFByZXNlbnRWYWx1ZShpZCkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmdldERhdGEoKSA/IHRoaXMuZ2V0RGF0YSgpW2lkXSA6IHVuZGVmaW5lZDtcclxuICAgICAgICByZXR1cm4gZGF0YSA/IGRhdGFbZGF0YS5sZW5ndGggLSAxXSA6IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZXREYXRhKGRhdGEpIHtcclxuICAgICAgICBsZXQgb2JqID0gZGF0YTtcclxuICAgICAgICBjb25zdCBwcmV2RGF0YSA9IHRoaXMuZ2V0RGF0YSgpO1xyXG4gICAgICAgIGlmIChwcmV2RGF0YSkge1xyXG4gICAgICAgICAgICBvYmogPSB7IC4uLnByZXZEYXRhLCAuLi5vYmogfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnNldEl0ZW0odGhpcy5uYW1lLCBidG9hKEpTT04uc3RyaW5naWZ5KG9iaikpKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldERhdGEoKSB7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKHRoaXMubmFtZSk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGEgIT09IG51bGwgPyBKU09OLnBhcnNlKGF0b2IoZGF0YSkpIDogdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEN1cnJlbnRJZChpZCkge1xyXG4gICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKHRoaXMuY3VycmVudElkLCBidG9hKGlkKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q3VycmVudElkKCkge1xyXG4gICAgICAgIGNvbnN0IGN1cnJlbnRJZCA9IHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKHRoaXMuY3VycmVudElkKTtcclxuICAgICAgICByZXR1cm4gY3VycmVudElkICE9PSBudWxsID8gYXRvYihjdXJyZW50SWQpIDogbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldEJ5SWQoaWQpIHtcclxuICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5nZXREYXRhKCk7XHJcbiAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbkFycmF5ID0gT2JqZWN0LmtleXMoZGF0YSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld0FycmF5ID0gc2Vzc2lvbkFycmF5LmZpbHRlcihpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhaWQuaW5jbHVkZXMoaXRlbSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBvYmogPSB7fTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgbmV3QXJyYXkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhW2tleV0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9ialtrZXldID0gZGF0YVtrZXldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKHRoaXMubmFtZSwgYnRvYShKU09OLnN0cmluZ2lmeShvYmopKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUFsbCgpIHtcclxuICAgICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSh0aGlzLmN1cnJlbnRJZCk7XHJcbiAgICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0odGhpcy5uYW1lKTtcclxuICAgIH1cclxufVxyXG4iXX0=